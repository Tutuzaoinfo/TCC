
<!doctype html>
<html lang="pt-br">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard ‚Äî Bancos & Investimentos</title>
  <link rel="stylesheet" href="styles.css">
  <!-- Chart.js CDN -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="title">üè¶ Dashboard ‚Ä¢ Bancos & Investimentos <span class="badge">Demo</span></div>
      <div class="controls">
        <select id="metricSelect" class="select" aria-label="M√©trica">
          <option value="Renda Fixa">Renda Fixa</option>
          <option value="A√ß√µes">A√ß√µes</option>
          <option value="FIIs">FIIs</option>
          <option value="C√¢mbio">C√¢mbio</option>
          <option value="ESG">ESG</option>
          <option value="Cr√©dito">Cr√©dito</option>
        </select>
        <select id="sortSelect" class="select" aria-label="Ordena√ß√£o">
          <option value="desc">Maior ‚Üí menor</option>
          <option value="asc">Menor ‚Üí maior</option>
        </select>
        <input id="searchInput" class="input" placeholder="Pesquisar banco..." />
      </div>
    </div>

    <div class="grid">
      <div class="card span-8">
        <h3>Comparativo por Banco (barra)</h3>
        <canvas id="barChart"></canvas>
      </div>
      <div class="card span-4">
        <h3>Participa√ß√£o por Classe (pizza)</h3>
        <canvas id="pieChart"></canvas>
      </div>

      <div class="card span-12">
        <h3>Tabela ‚Äî Distribui√ß√£o por Banco (em milh√µes)</h3>
        <table class="table" id="dataTable">
          <thead>
            <tr>
              <th>Banco</th>
              <th>Renda Fixa</th>
              <th>A√ß√µes</th>
              <th>FIIs</th>
              <th>C√¢mbio</th>
              <th>ESG</th>
              <th>Cr√©dito</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
    </div>

    <div class="footer">
      *Dados fict√≠cios apenas para demonstra√ß√£o. Personalize com seus n√∫meros (CSV incluso).
    </div>
  </div>

<script>
// --------- Dados (pode substituir por fetch de um endpoint/CSV) ---------
const rawData = [
  {"Banco":"Inter","Renda Fixa":320,"A√ß√µes":180,"FIIs":95,"C√¢mbio":60,"ESG":40,"Cr√©dito":210},
  {"Banco":"Nubank","Renda Fixa":280,"A√ß√µes":220,"FIIs":110,"C√¢mbio":45,"ESG":55,"Cr√©dito":190},
  {"Banco":"C6 Bank","Renda Fixa":350,"A√ß√µes":150,"FIIs":80,"C√¢mbio":70,"ESG":65,"Cr√©dito":230},
  {"Banco":"PicPay","Renda Fixa":300,"A√ß√µes":200,"FIIs":120,"C√¢mbio":50,"ESG":35,"Cr√©dito":175},
  {"Banco":"PayPal","Renda Fixa":278,"A√ß√µes":145,"FIIs":107,"C√¢mbio":63,"ESG":50,"Cr√©dito":239},
  {"Banco":"PagBank","Renda Fixa":379,"A√ß√µes":235,"FIIs":103,"C√¢mbio":65,"ESG":62,"Cr√©dito":197},
  {"Banco":"BTG Pactual","Renda Fixa":289,"A√ß√µes":200,"FIIs":89,"C√¢mbio":70,"ESG":33,"Cr√©dito":214},
  {"Banco":"Next","Renda Fixa":305,"A√ß√µes":176,"FIIs":74,"C√¢mbio":79,"ESG":57,"Cr√©dito":193},
  {"Banco":"Neon","Renda Fixa":382,"A√ß√µes":183,"FIIs":133,"C√¢mbio":63,"ESG":40,"Cr√©dito":222},
  {"Banco":"Sofisa Direto","Renda Fixa":321,"A√ß√µes":248,"FIIs":98,"C√¢mbio":49,"ESG":29,"Cr√©dito":158}
];


// Utilidades
const metrics = ["Renda Fixa","A√ß√µes","FIIs","C√¢mbio","ESG","Cr√©dito"];
function totalRow(r){ return metrics.reduce((s,m)=>s+(+r[m]||0),0); }

// Estado
let metric = "Renda Fixa";
let sortDir = "desc";
let search = "";

// DOM
const metricSelect = document.getElementById("metricSelect");
const sortSelect = document.getElementById("sortSelect");
const searchInput = document.getElementById("searchInput");
const tableBody = document.querySelector("#dataTable tbody");

// Eventos
metricSelect.addEventListener("change", e => { metric = e.target.value; render(); });
sortSelect.addEventListener("change", e => { sortDir = e.target.value; render(); });
searchInput.addEventListener("input", e => { search = e.target.value.toLowerCase(); render(); });

// Prepara√ß√£o de gr√°ficos
const barCtx = document.getElementById('barChart').getContext('2d');
const pieCtx = document.getElementById('pieChart').getContext('2d');
let barChart, pieChart;

function render(){
  // Filtra e ordena
  let rows = rawData
    .filter(r => r["Banco"].toLowerCase().includes(search))
    .sort((a,b)=> sortDir === "asc" ? (+a[metric]) - (+b[metric]) : (+b[metric]) - (+a[metric]));

  // TABELA
  tableBody.innerHTML = "";
  rows.forEach(r => {
    const tr = document.createElement("tr");
    const t = totalRow(r);
    tr.innerHTML = `
      <td><strong>${r["Banco"]}</strong></td>
      <td>${r["Renda Fixa"]}</td>
      <td>${r["A√ß√µes"]}</td>
      <td>${r["FIIs"]}</td>
      <td>${r["C√¢mbio"]}</td>
      <td>${r["ESG"]}</td>
      <td>${r["Cr√©dito"]}</td>
      <td><strong>${t}</strong></td>
    `;
    tableBody.appendChild(tr);
  });

  // BAR CHART
  const labels = rows.map(r=>r["Banco"]);
  const dataBar = rows.map(r=>r[metric]);
  if(barChart) barChart.destroy();
  barChart = new Chart(barCtx, {
    type: 'bar',
    data: {
      labels,
      datasets: [{ label: metric, data: dataBar }]
    },
    options: {
      responsive:true,
      maintainAspectRatio:false,
      plugins:{
        legend:{ display:false },
        tooltip:{ mode:'index', intersect:false }
      },
      scales:{
        x:{ ticks:{ color:'#cbd5e1' }, grid:{ display:false } },
        y:{ ticks:{ color:'#94a3b8' }, grid:{ color:'rgba(148,163,184,.15)' } }
      }
    }
  });

  // PIE CHART ‚Äî soma por classe (toda a carteira)
  const sumByMetric = metrics.map(m => rows.reduce((s,r)=>s+(+r[m]||0),0));
  if(pieChart) pieChart.destroy();
  pieChart = new Chart(pieCtx, {
    type:'pie',
    data:{
      labels: metrics,
      datasets:[{ data: sumByMetric }]
    },
    options:{
      responsive:true,
      maintainAspectRatio:false,
      plugins:{ legend:{ position:'bottom', labels:{ color:'#cbd5e1' } } }
    }
  });
}

render();
</script>
</body>
</html>
